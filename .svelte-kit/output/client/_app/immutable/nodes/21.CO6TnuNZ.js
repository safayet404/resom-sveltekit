import{t as p,a as n}from"../chunks/DNFbThfs.js";import"../chunks/BUQwjzWP.js";import{j as z,k as A,$ as B,s as m,e as b,f as a,m as f,g as r,r as _,t as k,u as D}from"../chunks/DoNDGHyy.js";import{s as y}from"../chunks/DC9tgs7-.js";import{i as P}from"../chunks/BX3J5sb_.js";import{h as E}from"../chunks/C2qLbvVc.js";import{r as R}from"../chunks/CPhAXEh1.js";import{e as F}from"../chunks/BZLr5Rgo.js";import{b as S}from"../chunks/06K-g5fM.js";import{i as G}from"../chunks/CVtg5WK5.js";import{a as H,s as K}from"../chunks/jw234UM_.js";import{p as L}from"../chunks/DTidVz0H.js";import{o as Q}from"../chunks/Dja85v4K.js";import{g as U}from"../chunks/1o6BxO2k.js";var V=p('<meta name="description" content="Reset Password">'),W=p('<p class="text-red-600 mb-4"> </p>'),X=p('<input type="password" placeholder="New Password" class="w-full mb-4 p-2 border rounded"> <input type="password" placeholder="Confirm Password" class="w-full mb-4 p-2 border rounded"> <button class="w-full bg-black text-white py-2 rounded">Reset Password</button>',1),Z=p('<p class="text-green-600 mt-4"> </p>'),ee=p('<section class="max-w-md mx-auto p-6 mt-10 bg-white shadow rounded"><h2 class="text-2xl font-bold mb-4 text-center">Reset Your Password</h2> <!> <!> <!></section>');function we(T,M){z(M,!1);const[j,q]=H(),C=()=>K(L,"$page",j);let u="",w="",l=f(""),g=f(""),d=f(""),o=f("");Q(()=>{const e=C().url;u=e.searchParams.get("token")||"",w=e.searchParams.get("email")||"",(!u||!w)&&a(o,"Invalid or expired reset link.")});async function N(){var i,c;if(a(o,""),a(d,""),r(l)!==r(g)){a(o,"Passwords do not match.");return}const s=await(await fetch("https://api-beta.resom.com.br/graphql/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          mutation SetPassword($email: String!, $password: String!, $token: String!) {
            setPassword(email: $email, password: $password, token: $token) {
              token
              refreshToken
              errors {
                field
                message
              }
            }
          }
        `,variables:{email:w,password:r(l),token:u}})})).json(),t=(c=(i=s==null?void 0:s.data)==null?void 0:i.setPassword)==null?void 0:c.errors;t!=null&&t.length?a(o,t[0].message):(a(d,"âœ… Password reset successfully! Redirecting..."),setTimeout(()=>U("/login"),2500))}G();var v=ee();E(e=>{var s=V();B.title="Reset Password",n(e,s)});var $=m(b(v),2);{var O=e=>{var s=W(),t=b(s,!0);_(s),k(()=>y(t,r(o))),n(e,s)};P($,e=>{r(o)&&e(O)})}var x=m($,2);{var I=e=>{var s=X(),t=D(s);R(t);var i=m(t,2);R(i);var c=m(i,2);S(t,()=>r(l),h=>a(l,h)),S(i,()=>r(g),h=>a(g,h)),F("click",c,N),n(e,s)};P(x,e=>{r(o)||e(I)})}var J=m(x,2);{var Y=e=>{var s=Z(),t=b(s,!0);_(s),k(()=>y(t,r(d))),n(e,s)};P(J,e=>{r(d)&&e(Y)})}_(v),n(T,v),A(),q()}export{we as component};
